--== FULL PET SPAWNER GUI (1 FILE) ==--

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()

-- Build GUI
local screenGui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
screenGui.Name = "PetSpawner"
screenGui.ResetOnSpawn = false

local frame = Instance.new("Frame", screenGui)
frame.Position = UDim2.new(0.5, -150, 0.5, -120)
frame.Size = UDim2.new(0, 300, 0, 240)
frame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
frame.BorderSizePixel = 0

local uiCorner = Instance.new("UICorner", frame)
uiCorner.CornerRadius = UDim.new(0, 12)

local nameBox = Instance.new("TextBox", frame)
nameBox.Name = "NameBox"
nameBox.PlaceholderText = "Enter Pet Name"
nameBox.Size = UDim2.new(1, -20, 0, 30)
nameBox.Position = UDim2.new(0, 10, 0, 10)
nameBox.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
nameBox.TextColor3 = Color3.new(1, 1, 1)
nameBox.ClearTextOnFocus = false
Instance.new("UICorner", nameBox).CornerRadius = UDim.new(0, 8)

-- Type Buttons
local petTypes = { "NP", "F", "R", "FR", "N", "NR", "NF", "NFR", "M", "MR", "MF", "MFR" }
local selectedType = "NP"

local typeContainer = Instance.new("Frame", frame)
typeContainer.Position = UDim2.new(0, 10, 0, 50)
typeContainer.Size = UDim2.new(1, -20, 0, 100)
typeContainer.BackgroundTransparency = 1

local grid = Instance.new("UIGridLayout", typeContainer)
grid.CellSize = UDim2.new(0, 60, 0, 30)
grid.CellPadding = UDim2.new(0, 5, 0, 5)

local typeButtons = {}

for _, typeName in ipairs(petTypes) do
	local btn = Instance.new("TextButton", typeContainer)
	btn.Name = typeName
	btn.Text = typeName
	btn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
	btn.TextColor3 = Color3.new(1, 1, 1)
	btn.AutoButtonColor = true
	Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 6)
	typeButtons[typeName] = btn

	btn.MouseButton1Click:Connect(function()
		selectedType = typeName
		for _, b in pairs(typeButtons) do
			b.TextColor3 = Color3.new(1, 1, 1)
		end
		btn.TextColor3 = Color3.fromRGB(0, 255, 0)
	end)
end

-- Spawn Button
local spawnBtn = Instance.new("TextButton", frame)
spawnBtn.Name = "Spawn"
spawnBtn.Text = "ðŸ§¬ Spawn Pet"
spawnBtn.Size = UDim2.new(1, -20, 0, 35)
spawnBtn.Position = UDim2.new(0, 10, 1, -45)
spawnBtn.BackgroundColor3 = Color3.fromRGB(0, 170, 100)
spawnBtn.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", spawnBtn).CornerRadius = UDim.new(0, 10)

-- ðŸ§  Pet Spawning Logic
local equippedPet = nil

local function followPlayer(pet)
	local root = character:WaitForChild("HumanoidRootPart")
	local petHRP = pet:WaitForChild("HumanoidRootPart")
	local offset = Vector3.new(3, 0, 3)

	RunService:BindToRenderStep("FollowPet", Enum.RenderPriority.Character.Value + 1, function()
		if pet and petHRP and root and pet.Parent then
			local target = root.Position + offset
			local direction = (target - petHRP.Position).Unit
			petHRP.Velocity = direction * 10
		end
	end)
end

local function toggleEquip(pet)
	if equippedPet == pet then
		equippedPet:Destroy()
		equippedPet = nil
		RunService:UnbindFromRenderStep("FollowPet")
	else
		if equippedPet then
			equippedPet:Destroy()
		end
		equippedPet = pet
		followPlayer(pet)
	end
end

spawnBtn.MouseButton1Click:Connect(function()
	local petName = nameBox.Text
	if petName == "" then warn("Enter a pet name") return end

	local petFolder = ReplicatedStorage:FindFirstChild("Pets")
	if not petFolder then warn("Pets folder missing in ReplicatedStorage") return end

	local petModel = petFolder:FindFirstChild(petName)
	if not petModel then warn("Pet not found: " .. petName) return end

	local petClone = petModel:Clone()
	petClone.Name = petName .. " [" .. selectedType .. "]"

	local root = character:FindFirstChild("HumanoidRootPart")
	if not root then warn("No HumanoidRootPart") return end

	petClone:SetPrimaryPartCFrame(root.CFrame * CFrame.new(3, 0, 3))
	petClone.Parent = workspace

	local clickDetector = Instance.new("ClickDetector", petClone.PrimaryPart)
	clickDetector.MouseClick:Connect(function()
		toggleEquip(petClone)
	end)
end)
